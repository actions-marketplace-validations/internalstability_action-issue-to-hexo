{"version":3,"file":"index.js","sources":["../dist-src/version.js","../dist-src/add-event-handler.js","../dist-src/oauth-app-octokit.js","../dist-src/emit-event.js","../dist-src/methods/get-user-octokit.js","../dist-src/methods/get-web-flow-authorization-url.js","../dist-src/methods/create-token.js","../dist-src/methods/check-token.js","../dist-src/methods/reset-token.js","../dist-src/methods/refresh-token.js","../dist-src/methods/scope-token.js","../dist-src/methods/delete-token.js","../dist-src/methods/delete-authorization.js","../dist-src/middleware/node/parse-request.js","../dist-src/middleware/node/send-response.js","../dist-src/middleware/on-unhandled-request-default.js","../dist-src/middleware/handle-request.js","../dist-src/middleware/node/index.js","../dist-src/middleware/cloudflare/parse-request.js","../dist-src/middleware/cloudflare/send-response.js","../dist-src/middleware/cloudflare/index.js","../dist-src/index.js"],"sourcesContent":["export const VERSION = \"3.4.0\";\n","export function addEventHandler(state, eventName, eventHandler) {\n    if (Array.isArray(eventName)) {\n        for (const singleEventName of eventName) {\n            addEventHandler(state, singleEventName, eventHandler);\n        }\n        return;\n    }\n    if (!state.eventHandlers[eventName]) {\n        state.eventHandlers[eventName] = [];\n    }\n    state.eventHandlers[eventName].push(eventHandler);\n}\n","import { Octokit } from \"@octokit/core\";\nimport { getUserAgent } from \"universal-user-agent\";\nimport { VERSION } from \"./version\";\nexport const OAuthAppOctokit = Octokit.defaults({\n    userAgent: `octokit-oauth-app.js/${VERSION} ${getUserAgent()}`,\n});\n","export async function emitEvent(state, context) {\n    const { name, action } = context;\n    if (state.eventHandlers[`${name}.${action}`]) {\n        for (const eventHandler of state.eventHandlers[`${name}.${action}`]) {\n            await eventHandler(context);\n        }\n    }\n    if (state.eventHandlers[name]) {\n        for (const eventHandler of state.eventHandlers[name]) {\n            await eventHandler(context);\n        }\n    }\n}\n","import { createOAuthUserAuth, } from \"@octokit/auth-oauth-user\";\nimport { emitEvent } from \"../emit-event\";\nexport async function getUserOctokitWithState(state, options) {\n    return state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n        async factory(options) {\n            const octokit = new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: options,\n            });\n            const authentication = (await octokit.auth({\n                type: \"get\",\n            }));\n            await emitEvent(state, {\n                name: \"token\",\n                action: \"created\",\n                token: authentication.token,\n                scopes: authentication.scopes,\n                authentication,\n                octokit,\n            });\n            return octokit;\n        },\n    });\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport function getWebFlowAuthorizationUrlWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        request: state.octokit.request,\n        ...options,\n        allowSignup: options.allowSignup || state.allowSignup,\n        scopes: options.scopes || state.defaultScopes,\n    };\n    return OAuthMethods.getWebFlowAuthorizationUrl({\n        clientType: state.clientType,\n        ...optionsWithDefaults,\n    });\n}\n","import * as OAuthAppAuth from \"@octokit/auth-oauth-app\";\nimport { emitEvent } from \"../emit-event\";\nexport async function createTokenWithState(state, options) {\n    const authentication = await state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"created\",\n        token: authentication.token,\n        scopes: authentication.scopes,\n        authentication,\n        octokit: new state.Octokit({\n            authStrategy: OAuthAppAuth.createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: authentication.token,\n                scopes: authentication.scopes,\n                refreshToken: authentication.refreshToken,\n                expiresAt: authentication.expiresAt,\n                refreshTokenExpiresAt: authentication.refreshTokenExpiresAt,\n            },\n        }),\n    });\n    return { authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport async function checkTokenWithState(state, options) {\n    return await OAuthMethods.checkToken({\n        // @ts-expect-error not worth the extra code to appease TS\n        clientType: state.clientType,\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function resetTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    if (state.clientType === \"oauth-app\") {\n        const response = await OAuthMethods.resetToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        });\n        await emitEvent(state, {\n            name: \"token\",\n            action: \"reset\",\n            token: response.authentication.token,\n            scopes: response.authentication.scopes || undefined,\n            authentication: {\n                type: \"token\",\n                tokenType: \"oauth\",\n                ...response.authentication,\n            },\n            octokit: new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: {\n                    clientType: state.clientType,\n                    clientId: state.clientId,\n                    clientSecret: state.clientSecret,\n                    token: response.authentication.token,\n                    scopes: response.authentication.scopes,\n                },\n            }),\n        });\n        return response;\n    }\n    const response = await OAuthMethods.resetToken({\n        clientType: \"github-app\",\n        ...optionsWithDefaults,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"reset\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function refreshTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.refreshToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.refreshToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        refreshToken: options.refreshToken,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"refreshed\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nimport { emitEvent } from \"../emit-event\";\nexport async function scopeTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.scopeToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.scopeToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"scoped\",\n        token: response.authentication.token,\n        authentication: {\n            type: \"token\",\n            tokenType: \"oauth\",\n            ...response.authentication,\n        },\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteToken({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteAuthorizationWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteAuthorization({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteAuthorization({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    await emitEvent(state, {\n        name: \"authorization\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"authorization.deleted\" event. The access for the app has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","export function parseRequest(request) {\n    const { method, url, headers } = request;\n    async function text() {\n        const text = await new Promise((resolve, reject) => {\n            let bodyChunks = [];\n            request\n                .on(\"error\", reject)\n                .on(\"data\", (chunk) => bodyChunks.push(chunk))\n                .on(\"end\", () => resolve(Buffer.concat(bodyChunks).toString()));\n        });\n        return text;\n    }\n    return { method, url, headers, text };\n}\n","export function sendResponse(octokitResponse, response) {\n    response.writeHead(octokitResponse.status, octokitResponse.headers);\n    response.end(octokitResponse.text);\n}\n","export function onUnhandledRequestDefault(request) {\n    return {\n        status: 404,\n        headers: { \"content-type\": \"application/json\" },\n        text: JSON.stringify({\n            error: `Unknown route: ${request.method} ${request.url}`,\n        }),\n    };\n}\n","// @ts-ignore - requires esModuleInterop flag\nimport fromEntries from \"fromentries\";\nexport async function handleRequest(app, { pathPrefix = \"/api/github/oauth\" }, request) {\n    // request.url may include ?query parameters which we don't want for `route`\n    // hence the workaround using new URL()\n    const { pathname } = new URL(request.url, \"http://localhost\");\n    const route = [request.method, pathname].join(\" \");\n    const routes = {\n        getLogin: `GET ${pathPrefix}/login`,\n        getCallback: `GET ${pathPrefix}/callback`,\n        createToken: `POST ${pathPrefix}/token`,\n        getToken: `GET ${pathPrefix}/token`,\n        patchToken: `PATCH ${pathPrefix}/token`,\n        patchRefreshToken: `PATCH ${pathPrefix}/refresh-token`,\n        scopeToken: `POST ${pathPrefix}/token/scoped`,\n        deleteToken: `DELETE ${pathPrefix}/token`,\n        deleteGrant: `DELETE ${pathPrefix}/grant`,\n    };\n    // handle unknown routes\n    if (!Object.values(routes).includes(route)) {\n        return null;\n    }\n    let json;\n    try {\n        const text = await request.text();\n        json = text ? JSON.parse(text) : {};\n    }\n    catch (error) {\n        return {\n            status: 400,\n            headers: { \"content-type\": \"application/json\" },\n            text: JSON.stringify({\n                error: \"[@octokit/oauth-app] request error\",\n            }),\n        };\n    }\n    const { searchParams } = new URL(request.url, \"http://localhost\");\n    const query = fromEntries(searchParams);\n    const headers = request.headers;\n    try {\n        if (route === routes.getLogin) {\n            const { url } = app.getWebFlowAuthorizationUrl({\n                state: query.state,\n                scopes: query.scopes ? query.scopes.split(\",\") : undefined,\n                allowSignup: query.allowSignup !== \"false\",\n                redirectUrl: query.redirectUrl,\n            });\n            return { status: 302, headers: { location: url } };\n        }\n        if (route === routes.getCallback) {\n            if (query.error) {\n                throw new Error(`[@octokit/oauth-app] ${query.error} ${query.error_description}`);\n            }\n            if (!query.state || !query.code) {\n                throw new Error('[@octokit/oauth-app] Both \"code\" & \"state\" parameters are required');\n            }\n            const { authentication: { token }, } = await app.createToken({\n                state: query.state,\n                code: query.code,\n            });\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"text/html\",\n                },\n                text: `<h1>Token created successfull</h1>\n    \n<p>Your token is: <strong>${token}</strong>. Copy it now as it cannot be shown again.</p>`,\n            };\n        }\n        if (route === routes.createToken) {\n            const { state: oauthState, code, redirectUrl } = json;\n            if (!oauthState || !code) {\n                throw new Error('[@octokit/oauth-app] Both \"code\" & \"state\" parameters are required');\n            }\n            const { authentication: { token, scopes }, } = await app.createToken({\n                state: oauthState,\n                code,\n                redirectUrl,\n            });\n            return {\n                status: 201,\n                headers: { \"content-type\": \"application/json\" },\n                text: JSON.stringify({ token, scopes }),\n            };\n        }\n        if (route === routes.getToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.checkToken({\n                token,\n            });\n            return {\n                status: 200,\n                headers: { \"content-type\": \"application/json\" },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.patchToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.resetToken({\n                token,\n            });\n            return {\n                status: 200,\n                headers: { \"content-type\": \"application/json\" },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.patchRefreshToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const { refreshToken } = json;\n            if (!refreshToken) {\n                throw new Error(\"[@octokit/oauth-app] refreshToken must be sent in request body\");\n            }\n            const result = await app.refreshToken({ refreshToken });\n            return {\n                status: 200,\n                headers: { \"content-type\": \"application/json\" },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.scopeToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.scopeToken({\n                token,\n                ...json,\n            });\n            return {\n                status: 200,\n                headers: { \"content-type\": \"application/json\" },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.deleteToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            await app.deleteToken({\n                token,\n            });\n            return { status: 204 };\n        }\n        // route === routes.deleteGrant\n        const token = headers.authorization?.substr(\"token \".length);\n        if (!token) {\n            throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n        }\n        await app.deleteAuthorization({\n            token,\n        });\n        return { status: 204 };\n    }\n    catch (error) {\n        return {\n            status: 400,\n            headers: { \"content-type\": \"application/json\" },\n            text: JSON.stringify({ error: error.message }),\n        };\n    }\n}\n","import { parseRequest } from \"./parse-request\";\nimport { sendResponse } from \"./send-response\";\nimport { onUnhandledRequestDefault } from \"../on-unhandled-request-default\";\nimport { handleRequest } from \"../handle-request\";\nfunction onUnhandledRequestDefaultNode(request, response) {\n    const octokitRequest = parseRequest(request);\n    const octokitResponse = onUnhandledRequestDefault(octokitRequest);\n    sendResponse(octokitResponse, response);\n}\nexport function createNodeMiddleware(app, { pathPrefix, onUnhandledRequest = onUnhandledRequestDefaultNode, } = {}) {\n    return async function (request, response, next) {\n        const octokitRequest = parseRequest(request);\n        const octokitResponse = await handleRequest(app, { pathPrefix }, octokitRequest);\n        if (octokitResponse) {\n            sendResponse(octokitResponse, response);\n        }\n        else if (typeof next === \"function\") {\n            next();\n        }\n        else {\n            onUnhandledRequest(request, response);\n        }\n    };\n}\n","export function parseRequest(request) {\n    // @ts-ignore Worker environment supports fromEntries/entries.\n    const headers = Object.fromEntries(request.headers.entries());\n    return {\n        method: request.method,\n        url: request.url,\n        headers,\n        text: () => request.text(),\n    };\n}\n","export function sendResponse(octokitResponse) {\n    return new Response(octokitResponse.text, {\n        status: octokitResponse.status,\n        headers: octokitResponse.headers,\n    });\n}\n","import { parseRequest } from \"./parse-request\";\nimport { sendResponse } from \"./send-response\";\nimport { handleRequest } from \"../handle-request\";\nimport { onUnhandledRequestDefault } from \"../on-unhandled-request-default\";\nasync function onUnhandledRequestDefaultCloudflare(request) {\n    const octokitRequest = parseRequest(request);\n    const octokitResponse = onUnhandledRequestDefault(octokitRequest);\n    return sendResponse(octokitResponse);\n}\nexport function createCloudflareHandler(app, { pathPrefix, onUnhandledRequest = onUnhandledRequestDefaultCloudflare, } = {}) {\n    return async function (request) {\n        const octokitRequest = parseRequest(request);\n        const octokitResponse = await handleRequest(app, { pathPrefix }, octokitRequest);\n        return octokitResponse\n            ? sendResponse(octokitResponse)\n            : await onUnhandledRequest(request);\n    };\n}\n","import { createOAuthAppAuth } from \"@octokit/auth-oauth-app\";\nimport { VERSION } from \"./version\";\nimport { addEventHandler } from \"./add-event-handler\";\nimport { OAuthAppOctokit } from \"./oauth-app-octokit\";\nimport { getUserOctokitWithState, } from \"./methods/get-user-octokit\";\nimport { getWebFlowAuthorizationUrlWithState, } from \"./methods/get-web-flow-authorization-url\";\nimport { createTokenWithState, } from \"./methods/create-token\";\nimport { checkTokenWithState, } from \"./methods/check-token\";\nimport { resetTokenWithState, } from \"./methods/reset-token\";\nimport { refreshTokenWithState, } from \"./methods/refresh-token\";\nimport { scopeTokenWithState, } from \"./methods/scope-token\";\nimport { deleteTokenWithState, } from \"./methods/delete-token\";\nimport { deleteAuthorizationWithState, } from \"./methods/delete-authorization\";\nexport { createNodeMiddleware } from \"./middleware/node/index\";\nexport { createCloudflareHandler } from \"./middleware/cloudflare/index\";\nexport class OAuthApp {\n    constructor(options) {\n        const Octokit = options.Octokit || OAuthAppOctokit;\n        this.type = (options.clientType ||\n            \"oauth-app\");\n        const octokit = new Octokit({\n            authStrategy: createOAuthAppAuth,\n            auth: {\n                clientType: this.type,\n                clientId: options.clientId,\n                clientSecret: options.clientSecret,\n            },\n        });\n        const state = {\n            clientType: this.type,\n            clientId: options.clientId,\n            clientSecret: options.clientSecret,\n            // @ts-expect-error defaultScopes not permitted for GitHub Apps\n            defaultScopes: options.defaultScopes || [],\n            allowSignup: options.allowSignup,\n            baseUrl: options.baseUrl,\n            log: options.log,\n            Octokit,\n            octokit,\n            eventHandlers: {},\n        };\n        this.on = addEventHandler.bind(null, state);\n        // @ts-expect-error TODO: figure this out\n        this.octokit = octokit;\n        this.getUserOctokit = getUserOctokitWithState.bind(null, state);\n        this.getWebFlowAuthorizationUrl = getWebFlowAuthorizationUrlWithState.bind(null, state);\n        this.createToken = createTokenWithState.bind(null, state);\n        this.checkToken = checkTokenWithState.bind(null, state);\n        this.resetToken = resetTokenWithState.bind(null, state);\n        this.refreshToken = refreshTokenWithState.bind(null, state);\n        this.scopeToken = scopeTokenWithState.bind(null, state);\n        this.deleteToken = deleteTokenWithState.bind(null, state);\n        this.deleteAuthorization = deleteAuthorizationWithState.bind(null, state);\n    }\n    static defaults(defaults) {\n        const OAuthAppWithDefaults = class extends this {\n            constructor(...args) {\n                super({\n                    ...defaults,\n                    ...args[0],\n                });\n            }\n        };\n        return OAuthAppWithDefaults;\n    }\n}\nOAuthApp.VERSION = VERSION;\n"],"names":["VERSION","addEventHandler","state","eventName","eventHandler","Array","isArray","singleEventName","eventHandlers","push","OAuthAppOctokit","Octokit","defaults","userAgent","getUserAgent","emitEvent","context","name","action","getUserOctokitWithState","options","octokit","auth","type","factory","authStrategy","createOAuthUserAuth","authentication","token","scopes","getWebFlowAuthorizationUrlWithState","optionsWithDefaults","clientId","request","allowSignup","defaultScopes","OAuthMethods","clientType","createTokenWithState","OAuthAppAuth","clientSecret","refreshToken","expiresAt","refreshTokenExpiresAt","checkTokenWithState","resetTokenWithState","response","undefined","tokenType","refreshTokenWithState","Error","scopeTokenWithState","deleteTokenWithState","createUnauthenticatedAuth","reason","deleteAuthorizationWithState","parseRequest","method","url","headers","text","Promise","resolve","reject","bodyChunks","on","chunk","Buffer","concat","toString","sendResponse","octokitResponse","writeHead","status","end","onUnhandledRequestDefault","JSON","stringify","error","handleRequest","app","pathPrefix","pathname","URL","route","join","routes","getLogin","getCallback","createToken","getToken","patchToken","patchRefreshToken","scopeToken","deleteToken","deleteGrant","Object","values","includes","json","parse","searchParams","query","fromEntries","getWebFlowAuthorizationUrl","split","redirectUrl","location","error_description","code","oauthState","authorization","substr","length","result","checkToken","resetToken","deleteAuthorization","message","onUnhandledRequestDefaultNode","octokitRequest","createNodeMiddleware","onUnhandledRequest","next","entries","Response","onUnhandledRequestDefaultCloudflare","createCloudflareHandler","OAuthApp","constructor","createOAuthAppAuth","baseUrl","log","bind","getUserOctokit","OAuthAppWithDefaults","args"],"mappings":"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"}